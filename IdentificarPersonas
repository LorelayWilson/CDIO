#include "IdentificarPersonas.h"
#include <EEPROM.h>
int numero;
int ultima_casilla;
int menu;
int multiplo = 1;

void setup()
{
  Serial.begin(9600);
  EEPROM.begin(512);

}

void loop()
{
  Serial.println("Pulse 1 para identificarse");
  Serial.println("Pulse 2 para comprobar el registro de trabajadores");
  Serial.println("Pulse 3 para borrar el registro actual");
  Serial.println("Pulse 4 para finalizar el programa");
  delay(5000);

  if (Serial.available() > 1) {
    menu = Serial.parseInt();
    switch (menu) {
      case 1:
        Serial.println("Introduzca su numero");
        delay(5000);
        numero = Serial.parseInt();
        ultima_casilla = localizarUltimaCasilla();
        leerNumero(numero, ultima_casilla);
        mostrarNumero(ultima_casilla);
        Serial.println(" ");
        break;

      case 2:
        Serial.print("El registro es: ");
        ultima_casilla = localizarUltimaCasilla();
        comprobarRegistro(ultima_casilla);
        Serial.println(" ");
        break;

      case 3:
        inicializarMemoriaEEPROM();
        Serial.println("Memoria reiniciada");
        Serial.println(" ");
        break;

      case 4:
        Serial.println("El programa se detendrá");
        Serial.println(" ");
        ESP.deepSleep(30000000);
        break;
    }
  }
  if (millis() > multiplo * 60000) {
    Serial.println("Pulse 1  si desea continuar utilizando el programa");
    Serial.println(" ");
    delay(5000);
    int x = Serial.parseInt();
    if (x != 1) {
      Serial.println("El programa se detendrá");
      Serial.println(" ");
      ESP.deepSleep(30000000);
    } else{
      multiplo++;
    }
  }
}